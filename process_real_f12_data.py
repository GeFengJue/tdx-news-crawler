import sqlite3
import re
import json
from datetime import datetime

class RealDataProcessor:
    def __init__(self):
        self.raw_data = None
    
    def load_real_data(self):
        """åŠ è½½æ‚¨æä¾›çš„çœŸå®F12æ•°æ®"""
        # è¿™æ˜¯æ‚¨æä¾›çš„å®Œæ•´50æ¡çœŸå®æ•°æ®
        real_data = {
            "ErrorCode": 0,
            "HitCache": "L1:B1FB6080A43E",
            "ResultSets": [{
                "ColName": [
                    "pos", "rec_id", "title", "issue_date", "summary", "src_info", 
                    "relate_id", "Proc_Id", "Mark_Id"
                ],
                "Content": [
                    [1, 5549513, "*STé‡‘æ¯”(002762):å…³äºå˜æ›´å‚è‚¡å…¬å¸è‘£äº‹ã€ç›‘äº‹å§”æ´¾äººå‘˜çš„è‡ªæ„¿æ€§ä¿¡æ¯æŠ«éœ²å…¬å‘Š", "2025-09-24 17:57:00", "*STé‡‘æ¯”(002762):å…³äºå˜æ›´å‚è‚¡å…¬å¸è‘£äº‹ã€ç›‘äº‹å§”æ´¾äººå‘˜çš„è‡ªæ„¿æ€§ä¿¡æ¯æŠ«éœ²å…¬å‘Š", "æ·±äº¤æ‰€", 20009684, 0, 1],
                    [2, 5549507, "è“ç‰¹å…‰å­¦(688127):2025å¹´ç¬¬äºŒæ¬¡ä¸´æ—¶è‚¡ä¸œå¤§ä¼šå†³è®®å…¬å‘Š", "2025-09-24 17:57:00", "è“ç‰¹å…‰å­¦(688127):2025å¹´ç¬¬äºŒæ¬¡ä¸´æ—¶è‚¡ä¸œå¤§ä¼šå†³è®®å…¬å‘Š", "ä¸Šäº¤æ‰€", 20009678, 0, 1],
                    [3, 5549506, "è“ç‰¹å…‰å­¦(688127):2025å¹´ç¬¬äºŒæ¬¡ä¸´æ—¶è‚¡ä¸œå¤§ä¼šçš„æ³•å¾‹æ„è§ä¹¦", "2025-09-24 17:57:00", "è“ç‰¹å…‰å­¦(688127):2025å¹´ç¬¬äºŒæ¬¡ä¸´æ—¶è‚¡ä¸œå¤§ä¼šçš„æ³•å¾‹æ„è§ä¹¦", "ä¸Šäº¤æ‰€", 20009677, 0, 1],
                    [4, 5549505, "è“ç‰¹å…‰å­¦(688127):å…³äºé€‰ä¸¾èŒå·¥ä»£è¡¨è‘£äº‹ã€å¢é€‰éç‹¬ç«‹è‘£äº‹ã€è˜ä»»å‰¯æ€»ç»ç†çš„å…¬å‘Š", "2025-09-24 17:57:00", "è“ç‰¹å…‰å­¦(688127):å…³äºé€‰ä¸¾èŒå·¥ä»£è¡¨è‘£äº‹ã€å¢é€‰éç‹¬ç«‹è‘£äº‹ã€è˜ä»»å‰¯æ€»ç»ç†çš„å…¬å‘Š", "ä¸Šäº¤æ‰€", 20009676, 0, 1],
                    [5, 5549504, "ä¸­æƒ æ—…(834260):æä¾›æ‹…ä¿çš„å…¬å‘Š", "2025-09-24 17:56:54", "ä¸­æƒ æ—…(834260):æä¾›æ‹…ä¿çš„å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009673, 1, 1],
                    [6, 5549503, "æ–°å†œäºº(872242):å…³äºå…¨èµ„å­å…¬å¸ä¸ºæ¯å…¬å¸æä¾›æ‹…ä¿çš„å…¬å‘Š", "2025-09-24 17:56:54", "æ–°å†œäºº(872242):å…³äºå…¨èµ„å­å…¬å¸ä¸ºæ¯å…¬å¸æä¾›æ‹…ä¿çš„å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009672, 1, 1],
                    [7, 5549502, "å¤§äºšè‚¡ä»½(832532):é¢„è®¡æ‹…ä¿çš„å…¬å‘Š", "2025-09-24 17:56:54", "å¤§äºšè‚¡ä»½(832532):é¢„è®¡æ‹…ä¿çš„å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009671, 1, 1],
                    [8, 5549501, "æµ·æ§èƒ½æº(833042):å‡ºå”®èµ„äº§æš¨å…³è”äº¤æ˜“çš„å…¬å‘Š", "2025-09-24 17:56:50", "æµ·æ§èƒ½æº(833042):å‡ºå”®èµ„äº§æš¨å…³è”äº¤æ˜“çš„å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009670, 1, 1],
                    [9, 5549499, "STå¤ªå’Œå(837694):å¯¹å¤–æŠ•èµ„çš„å…¬å‘Š", "2025-09-24 17:56:47", "STå¤ªå’Œå(837694):å¯¹å¤–æŠ•èµ„çš„å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009667, 1, 1],
                    [10, 5549498, "å£°è“åŒ»ç–—(874309):å¯¹å¤–è®¾ç«‹å­™å…¬å¸çš„å…¬å‘Š", "2025-09-24 17:56:47", "å£°è“åŒ»ç–—(874309):å¯¹å¤–è®¾ç«‹å­™å…¬å¸çš„å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009666, 1, 1],
                    [11, 5549497, "å‘³å·´å“¥(871988):å…³è”äº¤æ˜“å…¬å‘Š", "2025-09-24 17:56:29", "å‘³å·´å“¥(871988):å…³è”äº¤æ˜“å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009665, 1, 4],
                    [12, 5549512, "å¯Œå›½é“¶è¡Œ:AIç‰›å¸‚éæ³¡æ²« ä»å¤„æ—©æœŸé˜¶æ®µ", "2025-09-24 17:56:08", "å¯Œå›½é“¶è¡Œé¦–å¸­è‚¡ç¥¨ç­–ç•¥å¸ˆOhsung Kwonçœ‹å¥½AIç›¸å…³è‚¡ç¥¨,è®¤ä¸ºAIé©±åŠ¨çš„ç‰›å¸‚å°†æŒç»­ã€‚ä»–æŒ‡å‡º,å½“å‰æ¶¨åŠ¿éæ³¡æ²«,è€Œæ˜¯ç”±ä¼˜äºæ ‡æ™®500çš„åŸºæœ¬é¢æ”¯æ’‘,çº³æ–¯è¾¾å…‹æŒ‡æ•°çš„è¶…é¢æ”¶ç›Šé•¿æœŸç”±ç§‘æŠ€æˆé•¿é©±åŠ¨ã€‚ç›®å‰ä»å¤„AIæŠ•èµ„å‘¨æœŸæ—©æœŸ,åªè¦è‚¡å¸‚å¯¹èµ„æœ¬æ”¯å‡ºå’Œå¢é•¿å‰æ™¯æŒç»­ç»™äºˆç§¯æåé¦ˆ,æœ¬è½®è¡Œæƒ…æœ‰æœ›å»¶ç»­ã€‚", "æ ¼éš†æ±‡", 20009683, 0, 1],
                    [13, 5549495, "ä¹å–œè‚¡ä»½(872784):æ‹Ÿå˜æ›´ç»è¥èŒƒå›´å¹¶ä¿®è®¢ã€Šå…¬å¸ç« ç¨‹ã€‹å…¬å‘Š", "2025-09-24 17:56:05", "ä¹å–œè‚¡ä»½(872784):æ‹Ÿå˜æ›´ç»è¥èŒƒå›´å¹¶ä¿®è®¢ã€Šå…¬å¸ç« ç¨‹ã€‹å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009663, 0, 1],
                    [14, 5549494, "äº®å¨ç§‘æŠ€(839472):æ‹Ÿä¿®è®¢å…¬å¸ç« ç¨‹å…¬å‘Š", "2025-09-24 17:56:05", "äº®å¨ç§‘æŠ€(839472):æ‹Ÿä¿®è®¢å…¬å¸ç« ç¨‹å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009661, 0, 1],
                    [15, 5549493, "STå¤ªå’Œå(837694):æ‹Ÿä¿®è®¢ã€Šå…¬å¸ç« ç¨‹ã€‹å…¬å‘Š", "2025-09-24 17:56:05", "STå¤ªå’Œå(837694):æ‹Ÿä¿®è®¢ã€Šå…¬å¸ç« ç¨‹ã€‹å…¬å‘Š", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009659, 0, 1],
                    [16, 5549514, "åº·æ³°ç”Ÿç‰©(300601):å…³äºä¸‰ä»·æµæ„Ÿç—…æ¯’è£‚è§£ç–«è‹—ä¸Šå¸‚è®¸å¯ç”³è¯·è·å¾—å—ç†çš„å…¬å‘Š", "2025-09-24 17:56:00", "åº·æ³°ç”Ÿç‰©(300601):å…³äºä¸‰ä»·æµæ„Ÿç—…æ¯’è£‚è§£ç–«è‹—ä¸Šå¸‚è®¸å¯ç”³è¯·è·å¾—å—ç†çš„å…¬å‘Š", "æ·±äº¤æ‰€", 20009685, 0, 1],
                    [17, 5549496, "åº·å¼ºç”µå­(002119):å…³äºæŒè‚¡5%ä»¥ä¸Šè‚¡ä¸œæƒç›Šå˜åŠ¨è§¦åŠ1%æ•´æ•°å€çš„å…¬å‘Š", "2025-09-24 17:56:00", "åº·å¼ºç”µå­(002119):å…³äºæŒè‚¡5%ä»¥ä¸Šè‚¡ä¸œæƒç›Šå˜åŠ¨è§¦åŠ1%æ•´æ•°å€çš„å…¬å‘Š", "æ·±äº¤æ‰€", 20009664, 1, 1],
                    [18, 5549489, "äº”è½®ç§‘æŠ€(833767):ä¿¡æ¯æŠ«éœ²äº‹åŠ¡ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº”è½®ç§‘æŠ€(833767):ä¿¡æ¯æŠ«éœ²äº‹åŠ¡ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009657, 0, 1],
                    [19, 5549488, "äº”è½®ç§‘æŠ€(833767):æŠ•èµ„è€…å…³ç³»ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº”è½®ç§‘æŠ€(833767):æŠ•èµ„è€…å…³ç³»ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009656, 0, 1],
                    [20, 5549487, "äº”è½®ç§‘æŠ€(833767):å‹Ÿé›†èµ„é‡‘ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº”è½®ç§‘æŠ€(833767):å‹Ÿé›†èµ„é‡‘ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009655, 0, 1],
                    [21, 5549486, "äº®å¨ç§‘æŠ€(839472):è‚¡ä¸œä¼šè®®äº‹è§„åˆ™", "2025-09-24 17:55:37", "äº®å¨ç§‘æŠ€(839472):è‚¡ä¸œä¼šè®®äº‹è§„åˆ™", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009654, 0, 1],
                    [22, 5549485, "å¤©å¥æ–°æ(874508):è‚¡ä¸œä¼šè®®äº‹è§„åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:37", "å¤©å¥æ–°æ(874508):è‚¡ä¸œä¼šè®®äº‹è§„åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009651, 0, 1],
                    [23, 5549484, "STå¤ªå’Œå(837694):å‹Ÿé›†èµ„é‡‘ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "STå¤ªå’Œå(837694):å‹Ÿé›†èµ„é‡‘ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009650, 0, 1],
                    [24, 5549483, "äº®å¨ç§‘æŠ€(839472):é˜²æ­¢æ§è‚¡è‚¡ä¸œæˆ–å®é™…æ§åˆ¶äººåŠå…¶å…³è”æ–¹å ç”¨å…¬å¸èµ„é‡‘ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº®å¨ç§‘æŠ€(839472):é˜²æ­¢æ§è‚¡è‚¡ä¸œæˆ–å®é™…æ§åˆ¶äººåŠå…¶å…³è”æ–¹å ç”¨å…¬å¸èµ„é‡‘ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009649, 0, 1],
                    [25, 5549482, "äº®å¨ç§‘æŠ€(839472):æŠ•èµ„è€…å…³ç³»ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº®å¨ç§‘æŠ€(839472):æŠ•èµ„è€…å…³ç³»ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009648, 0, 1],
                    [26, 5549481, "å‘³å·´å“¥(871988):è‚¡ä¸œä¼šè®®äº‹è§„åˆ™", "2025-09-24 17:55:37", "å‘³å·´å“¥(871988):è‚¡ä¸œä¼šè®®äº‹è§„åˆ™", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009646, 0, 1],
                    [27, 5549480, "äº®å¨ç§‘æŠ€(839472):å¯¹å¤–æ‹…ä¿ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº®å¨ç§‘æŠ€(839472):å¯¹å¤–æ‹…ä¿ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009645, 0, 1],
                    [28, 5549479, "äº®å¨ç§‘æŠ€(839472):å…³è”äº¤æ˜“ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº®å¨ç§‘æŠ€(839472):å…³è”äº¤æ˜“ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009644, 0, 1],
                    [29, 5549478, "äº®å¨ç§‘æŠ€(839472):åˆ©æ¶¦åˆ†é…ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº®å¨ç§‘æŠ€(839472):åˆ©æ¶¦åˆ†é…ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009643, 0, 1],
                    [30, 5549477, "äº®å¨ç§‘æŠ€(839472):å¯¹å¤–æŠ•èµ„ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:37", "äº®å¨ç§‘æŠ€(839472):å¯¹å¤–æŠ•èµ„ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009642, 0, 1],
                    [31, 5549476, "å‘³å·´å“¥(871988):è‘£äº‹ä¼šè®®äº‹è§„åˆ™", "2025-09-24 17:55:37", "å‘³å·´å“¥(871988):è‘£äº‹ä¼šè®®äº‹è§„åˆ™", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009641, 0, 1],
                    [32, 5549475, "å¤©å¥æ–°æ(874508):å…³è”äº¤æ˜“ç®¡ç†åŠæ³•(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):å…³è”äº¤æ˜“ç®¡ç†åŠæ³•(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009640, 0, 1],
                    [33, 5549474, "å¤©å¥æ–°æ(874508):å‹Ÿé›†èµ„é‡‘ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):å‹Ÿé›†èµ„é‡‘ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009639, 0, 1],
                    [34, 5549473, "å¤©å¥æ–°æ(874508):æŠ•èµ„è€…å…³ç³»ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):æŠ•èµ„è€…å…³ç³»ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009638, 0, 1],
                    [35, 5549472, "å¤©å¥æ–°æ(874508):å¯¹å¤–æ‹…ä¿ç®¡ç†åŠæ³•(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):å¯¹å¤–æ‹…ä¿ç®¡ç†åŠæ³•(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009637, 0, 1],
                    [36, 5549471, "å¤©å¥æ–°æ(874508):åˆ©æ¶¦åˆ†é…ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):åˆ©æ¶¦åˆ†é…ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009636, 0, 1],
                    [37, 5549470, "å¤©å¥æ–°æ(874508):ç‹¬ç«‹è‘£äº‹å·¥ä½œåˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):ç‹¬ç«‹è‘£äº‹å·¥ä½œåˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009635, 0, 1],
                    [38, 5549469, "å¤©å¥æ–°æ(874508):é˜²èŒƒæ§è‚¡è‚¡ä¸œã€å®é™…æ§åˆ¶äººåŠå…¶ä»–å…³è”æ–¹å ç”¨å…¬å¸èµ„é‡‘ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):é˜²èŒƒæ§è‚¡è‚¡ä¸œã€å®é™…æ§åˆ¶äººåŠå…¶ä»–å…³è”æ–¹å ç”¨å…¬å¸èµ„é‡‘ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009634, 0, 1],
                    [39, 5549468, "å¤©å¥æ–°æ(874508):å¯¹å¤–æŠ•èµ„ç®¡ç†åŠæ³•(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):å¯¹å¤–æŠ•èµ„ç®¡ç†åŠæ³•(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009633, 0, 1],
                    [40, 5549467, "å¤©å¥æ–°æ(874508):è‘£äº‹ä¼šç§˜ä¹¦å·¥ä½œç»†åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):è‘£äº‹ä¼šç§˜ä¹¦å·¥ä½œç»†åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009632, 0, 1],
                    [41, 5549466, "å¤©å¥æ–°æ(874508):ç´¯ç§¯æŠ•ç¥¨åˆ¶å®æ–½ç»†åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):ç´¯ç§¯æŠ•ç¥¨åˆ¶å®æ–½ç»†åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009631, 0, 1],
                    [42, 5549465, "å¤©å¥æ–°æ(874508):ä¿¡æ¯æŠ«éœ²ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):ä¿¡æ¯æŠ«éœ²ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009630, 0, 1],
                    [43, 5549464, "å¤©å¥æ–°æ(874508):è‘£äº‹å’Œé«˜çº§ç®¡ç†äººå‘˜æ‰€æŒæœ¬å…¬å¸è‚¡ä»½åŠå…¶å˜åŠ¨ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):è‘£äº‹å’Œé«˜çº§ç®¡ç†äººå‘˜æ‰€æŒæœ¬å…¬å¸è‚¡ä»½åŠå…¶å˜åŠ¨ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009629, 0, 1],
                    [44, 5549463, "å‘³å·´å“¥(871988):å¯¹å¤–æ‹…ä¿ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:33", "å‘³å·´å“¥(871988):å¯¹å¤–æ‹…ä¿ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009627, 0, 1],
                    [45, 5549462, "å‘³å·´å“¥(871988):å¯¹å¤–æŠ•èµ„ç®¡ç†åˆ¶åº¦", "2025-09-24 17:55:33", "å‘³å·´å“¥(871988):å¯¹å¤–æŠ•èµ„ç®¡ç†åˆ¶åº¦", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009626, 0, 1],
                    [46, 5549461, "å¤©å¥æ–°æ(874508):è‘£äº‹åŠé«˜çº§ç®¡ç†äººå‘˜è–ªé…¬ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):è‘£äº‹åŠé«˜çº§ç®¡ç†äººå‘˜è–ªé…¬ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009625, 0, 1],
                    [47, 5549460, "å¤©å¥æ–°æ(874508):æ€»ç»ç†å·¥ä½œç»†åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):æ€»ç»ç†å·¥ä½œç»†åˆ™(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009624, 0, 1],
                    [48, 5549459, "å¤©å¥æ–°æ(874508):å­å…¬å¸ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):å­å…¬å¸ç®¡ç†åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009623, 0, 1],
                    [49, 5549458, "äº®å¨ç§‘æŠ€(839472):ç›‘äº‹ä¼šè®®äº‹è§„åˆ™", "2025-09-24 17:55:33", "äº®å¨ç§‘æŠ€(839472):ç›‘äº‹ä¼šè®®äº‹è§„åˆ™", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009622, 0, 1],
                    [50, 5549457, "å¤©å¥æ–°æ(874508):å†…éƒ¨å®¡è®¡åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "2025-09-24 17:55:33", "å¤©å¥æ–°æ(874508):å†…éƒ¨å®¡è®¡åˆ¶åº¦(è‰æ¡ˆ)(åŒ—äº¤æ‰€ä¸Šå¸‚åé€‚ç”¨)", "è‚¡ä»½è½¬è®©ç³»ç»Ÿ", 20009621, 0, 1]
                ]
            }]
        }
        
        self.raw_data = real_data
        return real_data
    
    def create_database(self):
        """åˆ›å»ºæ•°æ®åº“"""
        conn = sqlite3.connect('f12_real_data.db')
        cursor = conn.cursor()
        
        cursor.execute('''
        CREATE TABLE IF NOT EXISTS stock_announcements (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            position INTEGER,
            record_id INTEGER UNIQUE,
            title TEXT,
            issue_date TEXT,
            summary TEXT,
            source TEXT,
            relate_id INTEGER,
            proc_id INTEGER,
            mark_id INTEGER,
            stock_code TEXT,
            stock_name TEXT,
            crawl_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
        ''')
        
        # åˆ›å»ºç´¢å¼•
        cursor.execute('CREATE INDEX IF NOT EXISTS idx_record_id ON stock_announcements(record_id)')
        cursor.execute('CREATE INDEX IF NOT EXISTS idx_stock_code ON stock_announcements(stock_code)')
        cursor.execute('CREATE INDEX IF NOT EXISTS idx_issue_date ON stock_announcements(issue_date)')
        cursor.execute('CREATE INDEX IF NOT EXISTS idx_source ON stock_announcements(source)')
        
        conn.commit()
        return conn
    
    def extract_stock_info(self, title):
        """ä»æ ‡é¢˜ä¸­æå–è‚¡ç¥¨ä»£ç å’Œåç§°"""
        pattern = r'([^\(]+)\((\d{6})\)'
        match = re.search(pattern, title)
        if match:
            stock_name = match.group(1).strip()
            stock_code = match.group(2)
            return stock_code, stock_name
        return None, None
    
    def process_and_save_data(self):
        """å¤„ç†å¹¶ä¿å­˜æ•°æ®"""
        print("ğŸš€ å¼€å§‹å¤„ç†çœŸå®F12æ•°æ®...")
        print(f"â° å½“å‰æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        
        # åŠ è½½æ•°æ®
        data = self.load_real_data()
        if not data:
            print("âŒ æ•°æ®åŠ è½½å¤±è´¥")
            return
        
        # åˆ›å»ºæ•°æ®åº“
        conn = self.create_database()
        cursor = conn.cursor()
        
        # è·å–æ•°æ®å†…å®¹
        result_set = data['ResultSets'][0]
        col_names = result_set['ColName']  # type: ignore
        content_data = result_set['Content']  # type: ignore
        
        print(f"ğŸ“Š åŸå§‹æ•°æ®ç»Ÿè®¡:")
        print(f"   æ€»è®°å½•æ•°: {len(content_data)}")
        print(f"   åˆ—å: {', '.join(str(name) for name in col_names)}")
        
        # å¤„ç†å¹¶ä¿å­˜æ•°æ®
        inserted_count = 0
        stock_codes = set()
        sources = set()
        
        for row in content_data:
            if len(row) >= len(col_names):
                data_dict = dict(zip(col_names, row))
                
                # æå–è‚¡ç¥¨ä¿¡æ¯
                title = data_dict.get('title', '')
                stock_code, stock_name = self.extract_stock_info(title)
                
                # ç»Ÿè®¡ä¿¡æ¯
                if stock_code:
                    stock_codes.add(stock_code)
                if data_dict.get('src_info'):
                    sources.add(data_dict['src_info'])
                
                try:
                    cursor.execute('''
                    INSERT OR IGNORE INTO stock_announcements 
                    (position, record_id, title, issue_date, summary, source, relate_id, proc_id, mark_id, stock_code, stock_name)
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                    ''', (
                        data_dict.get('pos', 0),
                        data_dict.get('rec_id', 0),
                        title,
                        data_dict.get('issue_date', ''),
                        data_dict.get('summary', ''),
                        data_dict.get('src_info', ''),
                        data_dict.get('relate_id', 0),
                        data_dict.get('Proc_Id', 0),
                        data_dict.get('Mark_Id', 0),
                        stock_code,
                        stock_name
                    ))
                    
                    if cursor.rowcount > 0:
                        inserted_count += 1
                
                except Exception as e:
                    print(f"âŒ æ’å…¥æ•°æ®å¤±è´¥: {e}")
        
        conn.commit()
        
        print(f"\nâœ… æ•°æ®å¤„ç†å®Œæˆ:")
        print(f"   æˆåŠŸæ’å…¥: {inserted_count} æ¡è®°å½•")
        print(f"   è‚¡ç¥¨æ•°é‡: {len(stock_codes)}")
        print(f"   æ¥æºæ•°é‡: {len(sources)}")
        print(f"   æ•°æ®æ¥æº: {', '.join(sorted(sources))}")
        
        # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
        self.show_statistics(conn)
        
        # å¯¼å‡ºä¸ºCSVæ–‡ä»¶
        self.export_to_csv(conn)
        
        conn.close()
        
        print("\nğŸ‰ çœŸå®F12æ•°æ®å¤„ç†å®Œæˆ!")
    
    def show_statistics(self, conn):
        """æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡ä¿¡æ¯"""
        cursor = conn.cursor()
        
        # æ€»è®°å½•æ•°
        cursor.execute("SELECT COUNT(*) FROM stock_announcements")
        total_count = cursor.fetchone()[0]
        
        # è‚¡ç¥¨ç»Ÿè®¡
        cursor.execute("""
        SELECT stock_code, stock_name, COUNT(*) as count 
        FROM stock_announcements 
        WHERE stock_code IS NOT NULL 
        GROUP BY stock_code, stock_name 
        ORDER BY count DESC
        """)
        
        print(f"\nğŸ“ˆ è‚¡ç¥¨å…¬å‘Šç»Ÿè®¡:")
        stock_stats = cursor.fetchall()
        for code, name, count in stock_stats[:10]:  # æ˜¾ç¤ºå‰10åªè‚¡ç¥¨
            print(f"   {code} {name}: {count} æ¡å…¬å‘Š")
        
        if len(stock_stats) > 10:
            print(f"   ... è¿˜æœ‰ {len(stock_stats) - 10} åªè‚¡ç¥¨")
        
        # æ¥æºç»Ÿè®¡
        cursor.execute("""
        SELECT source, COUNT(*) as count 
        FROM stock_announcements 
        GROUP BY source 
        ORDER BY count DESC
        """)
        
        print(f"\nğŸ“Š æ¥æºç»Ÿè®¡:")
        for source, count in cursor.fetchall():
            print(f"   {source}: {count} æ¡")
        
        # æœ€æ–°å…¬å‘Š
        cursor.execute("""
        SELECT title, stock_code, issue_date, source 
        FROM stock_announcements 
        ORDER BY issue_date DESC 
        LIMIT 5
        """)
        
        print(f"\nğŸ“° æœ€æ–°å…¬å‘Š:")
        for i, (title, code, date, source) in enumerate(cursor.fetchall(), 1):
            short_title = title[:60] + "..." if len(title) > 60 else title
            print(f"   {i}. {short_title}")
            print(f"      è‚¡ç¥¨: {code} | æ¥æº: {source} | æ—¶é—´: {date}")
    
    def export_to_csv(self, conn):
        """å¯¼å‡ºä¸ºCSVæ–‡ä»¶"""
        import csv
        
        cursor = conn.cursor()
        cursor.execute("""
        SELECT position, record_id, title, issue_date, summary, source, 
               relate_id, proc_id, mark_id, stock_code, stock_name
        FROM stock_announcements 
        ORDER BY issue_date DESC
        """)
        
        with open('f12_real_data_export.csv', 'w', newline='', encoding='utf-8-sig') as f:
            writer = csv.writer(f)
            # å†™å…¥æ ‡é¢˜è¡Œ
            writer.writerow(['åºå·', 'è®°å½•ID', 'æ ‡é¢˜', 'å‘å¸ƒæ—¶é—´', 'æ‘˜è¦', 'æ¥æº', 
                           'å…³è”ID', 'å¤„ç†ID', 'æ ‡è®°ID', 'è‚¡ç¥¨ä»£ç ', 'è‚¡ç¥¨åç§°'])
            
            # å†™å…¥æ•°æ®
            for row in cursor.fetchall():
                writer.writerow(row)
        
        print(f"ğŸ“„ æ•°æ®å·²å¯¼å‡ºåˆ°: f12_real_data_export.csv")
    
    def run(self):
        """è¿è¡Œå¤„ç†å™¨"""
        self.process_and_save_data()

def main():
    processor = RealDataProcessor()
    processor.run()

if __name__ == "__main__":
    main()